<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The Server Module &mdash; BZRobots v1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="BZRobots v1.0 documentation" href="index.html" />
    <link rel="next" title="Headless - For headless servers" href="headless.html" />
    <link rel="prev" title="collide.py - collision library" href="collide.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="headless.html" title="Headless - For headless servers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="collide.html" title="collide.py - collision library"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">BZRobots v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-server">
<h1>The Server Module<a class="headerlink" href="#module-server" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
</ul>
<div class="section" id="server">
<h2>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="server.Server">
<em class="property">class </em><tt class="descclassname">server.</tt><tt class="descname">Server</tt><big>(</big><em>addr</em>, <em>team</em><big>)</big><a class="headerlink" href="#server.Server" title="Permalink to this definition">¶</a></dt>
<dd><p>Server that listens on the BZRC port and dispatches connections.</p>
<p>Each team has its own server which dispatches sessions to the Handler.
Only one connection is allowed at a time.  Any subsequent connections will
be rejected until the active connection closes.</p>
<dl class="method">
<dt id="server.Server.get_port">
<tt class="descname">get_port</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Server.get_port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Server.handle_accept">
<tt class="descname">handle_accept</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Server.handle_accept" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Server.handle_closed_handler">
<tt class="descname">handle_closed_handler</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Server.handle_closed_handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="handler">
<h2>Handler<a class="headerlink" href="#handler" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="server.Handler">
<em class="property">class </em><tt class="descclassname">server.</tt><tt class="descname">Handler</tt><big>(</big><em>sock</em>, <em>team</em>, <em>closed_callback</em><big>)</big><a class="headerlink" href="#server.Handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Handler which implements the BZRC protocol with one client.</p>
<p>Methods whose names start with <a href="#id1"><span class="problematic" id="id2">bzrc_</span></a> are automagically interpreted as
bzrc commands.  To create the command &#8220;xyz&#8221;, just create a method called
&#8220;bzrc_xyz&#8221;, and the Handler will automatically call it when the client
sends an &#8220;xyz&#8221; request.  You don&#8217;t have to add it to a table or anything.</p>
<dl class="method">
<dt id="server.Handler.ack">
<tt class="descname">ack</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#server.Handler.ack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Handler.bad_handshake">
<tt class="descname">bad_handshake</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Handler.bad_handshake" title="Permalink to this definition">¶</a></dt>
<dd>Called when the client gives an invalid handshake message.</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_accelx">
<tt class="descname">bzrc_accelx</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_accelx" title="Permalink to this definition">¶</a></dt>
<dd>accelx [??]
Used specifically for freezeTag.
currently not implemented</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_accely">
<tt class="descname">bzrc_accely</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_accely" title="Permalink to this definition">¶</a></dt>
<dd>accely [??]
Used specifically for freezeTag.
currently not implemented</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_angvel">
<tt class="descname">bzrc_angvel</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_angvel" title="Permalink to this definition">¶</a></dt>
<dd><p>angvel [tankid] [angular_velocity]
Sets the angular velocity of the tank.</p>
<p>The parameter is given as a multiple of maximum possible angular
velocity (1 is full speed), where positive values indicate counter-
clockwise motion, and negative values indicate clockwise motion. The
sign is consistent with the convention use in angles in the circle.
Returns a boolean (&#8220;ok&#8221; or &#8220;fail&#8221; as described under shoot).</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_bases">
<tt class="descname">bzrc_bases</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>bases
Request a list of bases.</p>
<dl class="docutils">
<dt>The response is a list, whose elements are of the form:</dt>
<dd>base [team color] [x1] [y1] [x2] [y2] ...</dd>
</dl>
<p>where (x1, y1), (x2, y2), etc. are the corners of the base in counter-
clockwise order and team color is the name of the owning team.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_constants">
<tt class="descname">bzrc_constants</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>constants
Request a list of constants.</p>
<p>These constants define the rules of the game and the behavior of the
world. The response is a list:</p>
<blockquote>
constant [name] [value]</blockquote>
<p>Name is a string. Value may be a number or a string. Boolean values
are 0 or 1.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_fireatwill">
<tt class="descname">bzrc_fireatwill</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_fireatwill" title="Permalink to this definition">¶</a></dt>
<dd>fireatwill
All tanks shoot (cheat).</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_flags">
<tt class="descname">bzrc_flags</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>flags
Request a list of visible flags.</p>
<dl class="docutils">
<dt>The response is a list of flag elements:</dt>
<dd>flag [team color] [possessing team color] [x] [y]</dd>
</dl>
<p>The team color is the color of the owning team, and the possessing
team color is the color of the team holding the flag. If no tanks are
carrying the flag, the possessing team is &#8220;none&#8221;. The coordinate
(x, y) is the current position of the flag. Note that the list may be
incomplete if visibility is limited.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_hammertime">
<tt class="descname">bzrc_hammertime</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_hammertime" title="Permalink to this definition">¶</a></dt>
<dd>hammertime
All tanks move (cheat).</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_help">
<tt class="descname">bzrc_help</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_help" title="Permalink to this definition">¶</a></dt>
<dd>help [command]
if not command is given, list the commands
otherwise, return specific help for a command</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_mytanks">
<tt class="descname">bzrc_mytanks</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_mytanks" title="Permalink to this definition">¶</a></dt>
<dd><p>mytanks
Request the status of the tanks controlled by this connection.</p>
<dl class="docutils">
<dt>The response is a list of tanks:</dt>
<dd><dl class="first last docutils">
<dt>mytank [index] [callsign] [status] [shots available]</dt>
<dd>[time to reload] [flag] [x] [y] [angle] [vx] [vy] [angvel]</dd>
</dl>
</dd>
</dl>
<p>Index is the 0 based index identifying this tank. This index is used
for instructions. The callsign is the tank&#8217;s unique identifier within
the game. The status is a string like &#8220;alive,&#8221; &#8220;dead,&#8221; etc. Shots
available is the number of shots remaining before a reload delay. Flag
is the color/name of the flag being held, or &#8220;-&#8221; if none is held. The
coordinate (x, y) is the current position. Angle is the direction the
tank is pointed, between negative pi and pi. The vector (vx, vy) is
the current velocity of the tank, and angvel is the current angular
velocity of the tank (in radians per second).</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_obstacles">
<tt class="descname">bzrc_obstacles</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_obstacles" title="Permalink to this definition">¶</a></dt>
<dd><p>obstacles
Request a list of obstacles.</p>
<dl class="docutils">
<dt>The response is a list, whose elements are of the form:</dt>
<dd>obstacle [x1] [y1] [x2] [y2] ...</dd>
</dl>
<p>where (x1, y1), (x2, y2), etc. are the corners of the obstacle in
counter-clockwise order.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_othertanks">
<tt class="descname">bzrc_othertanks</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_othertanks" title="Permalink to this definition">¶</a></dt>
<dd><p>othertanks
Request the status of other tanks in the game (those not
controlled by this connection.</p>
<dl class="docutils">
<dt>The response is a list of tanks:</dt>
<dd>othertank [callsign] [color] [status] [flag] [x] [y] [angle]</dd>
</dl>
<p>where callsign, status, flag, x, y, and angle are as described under
mytanks and color is the name of the team color.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_quit">
<tt class="descname">bzrc_quit</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_quit" title="Permalink to this definition">¶</a></dt>
<dd><p>quit
Disconnects the session.</p>
<p>This is technically an extension to the BZRC protocol.  We should
really backport this to BZFlag.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_scores">
<tt class="descname">bzrc_scores</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>scores
Request the scores of all teams. A score is generated for each team
pair in a table:</p>
<blockquote>
<blockquote>
[team 1]   [team 2]   ...</blockquote>
<p>[team 1]      0       [score]    ...
[team 2]   [score]       0       ...</p>
</blockquote>
<p>Notice that a team generates no score when compared against itself.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_shoot">
<tt class="descname">bzrc_shoot</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_shoot" title="Permalink to this definition">¶</a></dt>
<dd><p>shoot [tankid]
Request the tank indexed by the given parameter to fire a shot.</p>
<dl class="docutils">
<dt>Returns either:</dt>
<dd>ok [comment]</dd>
<dt>or:</dt>
<dd>fail [comment]</dd>
</dl>
<p>where the comment is optional.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_shots">
<tt class="descname">bzrc_shots</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_shots" title="Permalink to this definition">¶</a></dt>
<dd><p>shots
Reports a list of shots.</p>
<dl class="docutils">
<dt>The response is a list of shot lines:</dt>
<dd>shot [x] [y] [vx] [vy]</dd>
</dl>
<p>where (c, y) is the current position of the shot and (vx, vy) is the
current velocity.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_speed">
<tt class="descname">bzrc_speed</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>speed [tankid] [speed]
Request the tank to accelerate as quickly as possible to the
specified speed.</p>
<p>The speed is given as a multiple of maximum possible speed (1 is full
speed). A negative parameter will cause the tank to go in reverse.
Returns a boolean (&#8220;ok&#8221; or &#8220;fail&#8221; as described under shoot).</p>
<p>Mock objects needed?
&gt;&gt;&gt; args = [&#8216;speed&#8217;, &#8216;1&#8217;, &#8216;1&#8217;]
&gt;&gt;&gt; Handler.bzrc_speed(Handler(), args)
fail</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_teams">
<tt class="descname">bzrc_teams</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_teams" title="Permalink to this definition">¶</a></dt>
<dd><p>teams
Request a list of teams.</p>
<dl class="docutils">
<dt>The response will be a list, whose elements are of the form:</dt>
<dd>team [color] [playercount]</dd>
</dl>
<p>Color is the identifying team color/team name. Playercount is the
number of tanks on the team.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.bzrc_timer">
<tt class="descname">bzrc_timer</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.bzrc_timer" title="Permalink to this definition">¶</a></dt>
<dd><p>timer
Requests how much time has passed and what time limit exists.</p>
<blockquote>
timer [time elapsed] [time limit]</blockquote>
<p>Time elapsed is the number of seconds that the server has been alive,
while time limit is the given limit. Once the limit is reached, the
server will stop updating the game.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Handler.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Handler.collect_incoming_data">
<tt class="descname">collect_incoming_data</tt><big>(</big><em>chunk</em><big>)</big><a class="headerlink" href="#server.Handler.collect_incoming_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Handler.found_terminator">
<tt class="descname">found_terminator</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Handler.found_terminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when Asynchat finds an end-of-line.</p>
<p>Note that Asynchat ensures that our input buffer contains everything
up to but not including the newline character.</p>
</dd></dl>

<dl class="method">
<dt id="server.Handler.handle_close">
<tt class="descname">handle_close</tt><big>(</big><big>)</big><a class="headerlink" href="#server.Handler.handle_close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="server.Handler.invalid_args">
<tt class="descname">invalid_args</tt><big>(</big><em>args</em><big>)</big><a class="headerlink" href="#server.Handler.invalid_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">The Server Module</a><ul>
<li><a class="reference external" href="#server">Server</a></li>
<li><a class="reference external" href="#handler">Handler</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="collide.html"
                                  title="previous chapter">collide.py - collision library</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="headless.html"
                                  title="next chapter">Headless - For headless servers</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/server.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="headless.html" title="Headless - For headless servers"
             >next</a> |</li>
        <li class="right" >
          <a href="collide.html" title="collide.py - collision library"
             >previous</a> |</li>
        <li><a href="index.html">BZRobots v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Jared Forsyth, Andrew McNabb.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>